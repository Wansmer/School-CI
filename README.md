# School-CI: непрерывная интеграция - ни один коммит не уйдет не собранным. 

> Версия node: v13.11.0

## Начало работы:
1. Клонировать репозиторий с проектом;
2. В командной строке перейти в директорию проекта и переключится на ветку задания, которая была написана в тикете:
```bash
% git checkout NAME_OF_BRANCH
```

## Предварительная настройка: 
1. Перейти в поддиректорию `./server`;
2. Создать файл `.env` в корне поддиректории;
3. Добавить в файл следующий текст:
```json
SECRET_KEY = 'Bearer YOUR_SECRET_KEY'
NODE_TLS_REJECT_UNAUTHORIZED = '0'
```

4. Убедиться, что файл сохранен, а значение SECRET_KEY начинается с Bearer<пробел>;
5. Перейти к запуску проекта.

## Запуск проекта: 
1. В командной строке перейти в директорию проекта и запустить команды последовательно: 
  - Предварительная установка пакетов:
```bash
% npm i
``` 
  - Установка пакетов в поддиректориях `./client` и `./server`:
```bash
% npm run postinstall
```
  - Запуск серверов (client - порт 3000, server - порт 3001):
```bash
% npm run start
```
2. ...
3. PROFIT! Проект запущен и автоматически открылся в вашем браузере по адресу [http://localhost:3000](http://localhost:3000).

## Домашнее задание: тесты

### Unit tests

#### Блоки приложения Node.js (./server) 
1. Модуль server.js - сервер express. **Тестируется:** проверка на корректность порта, т.к. именно на указанный порт ожидается обращение клиентского приложения;
2. Модуль queueAPI.js - работа с файлом очереди. **Тестируется:** проверяются все методы класса queueAPI с созданием реального файла, хранящего очередь;
3. Модули API (./api/builds/builds.js и ./api/settings/settings.js) - обращение к внешнему API для получения данных из DB. Тестируется: корректность адреса обращения к внешнему API и правильность возвращаемых результатов;
4. Модули роутинга (./api/routes/builds.js и ./api/routes/settings.js) - разбивка обработки сетевых запросов. Не тестируется: каждый метод дефолтного express router не содержит собственной логики - просто вызывает контролеры, которые тестируются отдельно;
5. Модули контроллеров (./api/controllers/builds.js и ./api/controllers/settings.js). **Тестируется:** правильность возвращаемых данных, согласно заранее заданным образцам результата;
6. Модуль GitHelper (./app/GitHelper.js) - класс, содержащий в себе методы для работы в git и github. **Тестируется:**  корректность консольных команд, выполняемых дочерним процессом внутри методов, корректность задания рабочей директории для выполнения консольных команд, правильность возвращаемых данных, если таковые предполагаются;
7. Модуль Builder (./app//Builder.js) - класс, содержащий в себе методы для осуществления сборок из очереди. **Тестируется:** корректность консольных команд, передаваемых в дочерние процессы, корректность директории для выполнения команд, правильность возвращаемых данных, если таковые предполагаются; 
> **Примечание по модулю Builder:** класс содержит методы, которые вызывают уже ранее протестированные методы этого же класса, вызывающие сайдэффекты. По идее, если их просто закомментировать, приложение сломается, но как тогда тестировать их наличие в методе?

