# School-CI: непрерывная интеграция - ни один коммит не уйдет не собранным. 

> Версия node: v13.11.0

## Начало работы:
1. Клонировать репозиторий с проектом;
2. В командной строке перейти в директорию проекта и переключится на ветку задания, которая была написана в тикете:
```bash
% git checkout NAME_OF_BRANCH
```

## Предварительная настройка: 
1. Перейти в поддиректорию `./server`;
2. Создать файл `.env` в корне поддиректории;
3. Добавить в файл следующий текст:
```json
SECRET_KEY = 'Bearer YOUR_SECRET_KEY'
NODE_TLS_REJECT_UNAUTHORIZED = '0'
```

4. Убедиться, что файл сохранен, а значение SECRET_KEY начинается с Bearer<пробел>;
5. Перейти к запуску проекта.

## Запуск проекта: 
1. В командной строке перейти в директорию проекта и запустить команды последовательно: 
  - Предварительная установка пакетов:
```bash
% npm i
``` 
  - Установка пакетов в поддиректориях `./client` и `./server`:
```bash
% npm run postinstall
```
  - Запуск серверов (client - порт 3000, server - порт 3001):
```bash
% npm run start
```
2. ...
3. PROFIT! Проект запущен и автоматически открылся в вашем браузере по адресу [http://localhost:3000](http://localhost:3000).

## Домашнее задание: тесты

### Unit tests

#### Блоки приложения Node.js (./server) 
1. Модуль server.js - сервер express. Не естируется: никакой логики в этот модуль не зашито;
2. Модуль queueAPI.js - работа с файлом очереди. **Тестируется:** проверяются все методы класса queueAPI с созданием реального файла, хранящего очередь;
3. Модули API (./api/builds/builds.js и ./api/settings/settings.js) - обращение к внешнему API для получения данных из DB. Тестируется: корректность адреса обращения к внешнему API и правильность возвращаемых результатов;
4. Модули роутинга (./api/routes/builds.js и ./api/routes/settings.js) - разбивка обработки сетевых запросов. Не тестируется: каждый метод дефолтного express router не содержит собственной логики - просто вызывает контролеры, которые тестируются отдельно;
5. Модули контроллеров (./api/controllers/builds.js и ./api/controllers/settings.js). **Тестируется:** правильность возвращаемых данных, согласно заранее заданным образцам результата;
6. Модуль GitHelper (./app/GitHelper.js) - класс, содержащий в себе методы для работы в git и github. **Тестируется:**  корректность консольных команд, выполняемых дочерним процессом внутри методов, корректность задания рабочей директории для выполнения консольных команд, правильность возвращаемых данных, если таковые предполагаются;
7. Модуль Builder (./app//Builder.js
) - класс, содержащий в себе методы для осуществления сборок из очереди. **Тестируется:** корректность консольных команд, передаваемых в дочерние процессы, корректность директории для выполнения команд, правильность возвращаемых данных, если таковые предполагаются, вызов всех функций внутри метода (если метод не предполагает логики); 

### Integration tests

#### Работа клиентского приложения. Сценарии.

1. Страница настроек (/history):
    - Отображается правильный заголовок;
    - Отображается правильный title;
    - Клик по заголовку страницы переадресует на адрес '/history';
    - При клике на любой тикер идет переадресация согласно id тикета;
    - В момент загрузки TicketList кнопка 'Run build' задизейблена;
    - Кнопка настроек ведет на страницу настроек (/settings);
    - Кнопка настроек имеет класс .Button_text_hidden;
    - Присутствует кнопка 'Show more'; 

2. Страница с деталями сборки (/build/:buildId):
    - Отображается правильный заголовок;
    - Отображается правильный title;
    - Клик по заголовку страницы переадресует на адрес '/history';
    - Во время загрузку кнопка 'Rebuild' задизейблена;
    - Кнопка настроек ведет на страницу настроек (/settings);
    - Блок с классом .Ticket имеет класс .Ticket_show_details;
    - После нажатия, кнопка 'Rebuild
    ' дизейблится и осуществляется переход на страницу новой сборки;

3. Страница настроек (/settings):
    - Отображается правильный заголовок;
    - Отображается правильный title;
    - Клик по заголовку страницы переадресует на адрес '/';
    - Input 'Github repository' в фокусе;
    - В блоках Input без текста отсутствует элемент span (.Input-Icon .Icon
     .Icon_inputClear);
    - Клик по кнопке 'Cancel' страницы переадресует на адрес '/';
    - При сабмите формы кнопки 'Save' и 'Cancel' задизейблены;
    - Клик по span (.Input-Icon .Icon .Icon_inputClear) удаяет value
     текущего input;
     
4. Главная страница ('/'): 
    - Если настроек нет - отображается Home;
    - Если настройки есть - отображается History;
    - Кнопка настроек в хэдэре ведет на страницу настроек;
    - Кнопка настроек в элементе Land ведет на страницу настроек;
    
